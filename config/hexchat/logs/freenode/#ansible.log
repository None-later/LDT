**** BEGIN LOGGING AT Fri Nov 23 10:27:09 2018

Nov 23 10:27:09 *	Now talking on #ansible
Nov 23 10:27:09 *	Topic for #ansible is: https://docs.ansible.com * latest releases: 2.7.2 / 2.6.8 / 2.5.11
Nov 23 10:27:09 *	Topic for #ansible set by mattclay!sid166880@ansible/staff/mattclay (Thu Nov 15 22:08:55 2018)
Nov 23 10:27:35 <lufimtse>	Hello guys. Is there a way to change a user password when you're connecting as a non-root user (who is not a sudoer)?
Nov 23 10:27:39 <zofrex>	whole play would also be acceptable
Nov 23 10:27:45 <zofrex>	but I absolutely need this to keep executing if one host fails
Nov 23 10:27:49 <zofrex>	which seems to rule out serial?
Nov 23 10:27:53 <lufimtse>	the user module expects become priviledges..
Nov 23 10:28:03 <abyss>	winem_: so the last task in play would be: set var: node_number + 1? and then in delegate_host: ansible_play_hosts[node_number]?
Nov 23 10:28:25 <winem_>	yes, I think I would go for something like that 
Nov 23 10:28:48 <zofrex>	is there any way to group multiple tasks as one task, so then with forks: 1, only one would happen at a time?
Nov 23 10:29:32 <Kelsar>	I have a expression that i want to mix with manual generated entries in a list, how do i do it without beeing ugly?
Nov 23 10:29:33 <Kelsar>	"{{ groups['getcloser'] | map('extract', hostvars, ['ansible_host']) | map('regex_replace', '$', ':9100') | list }}"
Nov 23 10:30:04 <winem_>	block is used to group tasks but that does not support serialization :/
Nov 23 10:31:04 <abyss>	winem_: ok, thank you, I will try. But at fist I need to set this variable, right? So I should set this variable at the begiining of play (as global var) and then increase it at the end of play by: set_fact: seq: {{ seq + 1 }} ?
Nov 23 10:31:53 <Kelsar>	also that expression yields onle :9100 instead of ansible_host:9100
Nov 23 10:34:51 <winem_>	yes, abyss
Nov 23 10:36:58 <abyss>	winem_: thank you very much :) I go to check it :)
Nov 23 10:44:49 <abyss>	winem_: ok, it not so easy I have command when I add more nodes to cluster ;) So on first node I will do command_to_create_clster --init node1... But on node2 I need to do: command_to_create_clster --init node1,node2, for thirs: command_to_create_clster --init node1,node2,node3 ....
Nov 23 10:47:50 <abyss>	I can do variable like init_node: node1 when ansible_play_hosts[0], init_node: node1,node2 when ansible_play_hosts[1] etc... ;)
Nov 23 10:48:13 <Kelsar>	in the expression above, why is ansible_host always empty?
Nov 23 10:48:36 <winem_>	then I would create a 2nd fact at the end of the play that creates a list and appends the current node name or index. but this gets more and more dirty 
Nov 23 10:49:03 <abyss>	yeah, but probably it is still better than long playbook? Or not?;)
Nov 23 10:50:05 <abyss>	I need this playbook to easy modify because people will be use this playbook with different inventories, so they will be modify 'hosts:' etc to make it order , so less modification of playbook then better
Nov 23 10:50:45 <tuxick>	when using with_items for a path:{{item}}, isn't there simple way to make it skip files that don't exist?
Nov 23 10:50:52 <tuxick>	in this case for lineinfile
Nov 23 10:51:20 <tuxick>	skip or at least not bail out with error
Nov 23 10:57:04 <tuxick>	hm
Nov 23 10:57:37 <winem_>	abyss: agree and see the reason why you do it like that :) 
Nov 23 11:35:48 <zofrex>	I found a way to execute tasks in serial for some tasks but not all!
Nov 23 11:35:57 <zofrex>	this was the clue in the docs
Nov 23 11:36:00 <zofrex>	"When an include statement loads different tasks for different hosts, the linear strategy keeps the hosts in lock-step by alternating which hosts are executing tasks while doing a noop for all other hosts."
Nov 23 11:36:17 <zofrex>	it's not pretty but here it is: https://gist.github.com/zofrex/add24ea058f30d146ac5e9dfc283ec45
Nov 23 11:39:49 <zofrex>	by creating multiple symlinks to the file I want to include, ansible can no longer tell it's the same file, nor the same tasks, and treats them as different tasks - triggering the behaviour documented above
Nov 23 11:40:03 <zofrex>	thus giving us opt-in serialisation in the middle of a parallel execution :D
Nov 23 11:42:41 <herald85>	zofrex: I need to shower after reading that
Nov 23 11:43:02 <zofrex>	:D
Nov 23 11:43:03 <zofrex>	thanks, I get that a lot
Nov 23 12:10:48 <abyss>	winem_: Are you still around?;)
Nov 23 12:11:06 <winem_>	abyss: yes :) 
Nov 23 12:13:25 <abyss>	most of things works ;) But I have a trouble with increasing vars after each interation, because when I do set_fact, it probably set_fact on the node where I issued this task. So in another iteration I have stil old variable... I do at as the last task something like this: - set_fact: node_number: "{{ node_number + 1 }}"
Nov 23 12:13:50 <abyss>	is the way to increase this variable globally? For example register for each node?;)
Nov 23 12:14:53 <abyss>	anyway I'm suprised that most thing works as intended :D Playbook is 3x shorter :)
Nov 23 12:20:28 <abyss>	winem_: maybe the only way to get this variable is something like this: set fact: node_number: {{ hostvars[ansible_play_hosts[current_play_index - 1]]['node_number'] } with leaving the last task?;)
Nov 23 12:23:03 <winem_>	abyss: I think there is no way around the reference via hostvars[...]
Nov 23 12:23:31 <winem_>	but I'm really tired and start to do stupid mistakes.. so I might be wrong 
Nov 23 12:23:42 <abyss>	ok but how to get current_play_index - 1? ;) ansible_play_hosts.index - it will be ok?;)
Nov 23 12:24:03 <abyss>	winem_: ok, yeah it late for me as well :( Thank you anyway, you help me a lot apreciate it :)
Nov 23 12:24:20 <winem_>	oh, thanks. I'm always happy to help 
Nov 23 12:25:11 <winem_>	yeah, it's almost 1 a.m. here. just wanted to push an update for my PR and I'm so close to haev it done, but I do stupid things... but how should I go to sleep when I know that I'm that close to the solution? :D 
Nov 23 12:25:55 <winem_>	maybe I'm not stupid and just found something fishy.. maybe a bug... let's see 
Nov 23 12:26:13 *	winem_ goes back into his cave and cuddles with the sysctl module 
Nov 23 12:26:42 <abyss>	winem_: the same :D I can't leave it when I so close to finish this #@%^ playbook ;)
Nov 23 12:26:47 <abyss>	ok good luck :)
Nov 23 12:27:02 <winem_>	haha, thanks! 
Nov 23 12:27:28 <winem_>	but I run out of coke.. and somehow the guys in malaysia do not have that much gas stations... 
Nov 23 12:27:45 <abyss>	lol
Nov 23 12:48:45 <memoryleak>	Hi I'm using ansible 2.7 and whenever I seem to access a variable I get this error: "ERROR! failed to combine variables, expected dicts but got a 'dict' and a 'AnsibleSequence': 
Nov 23 12:48:45 <memoryleak>	{}
Nov 23 12:48:45 <memoryleak>	[{"debug": {"var": "ansible_distribution_version"}}]
Nov 23 12:48:45 <memoryleak>	ERROR: 
Nov 23 12:48:45 <memoryleak>	"
Nov 23 12:49:13 <memoryleak>	yaml piec looks like this: 
Nov 23 12:49:13 <memoryleak>	- debug:
Nov 23 12:49:13 <memoryleak>	    var: ansible_distribution_version
Nov 23 12:53:00 <agaffney>	can you show a gist/pastebin of the playbook and the full error output?
Nov 23 12:53:57 <agaffney>	that error sounds like you're trying to use a list with |combine()
Nov 23 12:58:46 <winem_>	I'm currently testing a super small change on the sysctl module which is actually just about the string formatting but I managed it twice now to create a kernel panic with OoM and no killable process after the first few keys were set. is there anything likely to create a leak? known pitfalls with a loop or something like that? 
Nov 23 12:59:45 <winem_>	mem = 4G 
Nov 23 13:00:57 <winem_>	ah it happens when I allow IPv4 forwarding 
Nov 23 13:01:11 <winem_>	but instant.. wtf..
Nov 23 13:02:26 <memoryleak>	agaffney, this is all of it https://www.irccloud.com/pastebin/036aB0ur/
Nov 23 13:06:10 <memoryleak>	agaffney: looks like something wrong with my ansible role
Nov 23 13:10:11 <winem_>	holy, that error was evil as stupid.. that would have killed each host... time to go to bed now 
Nov 23 13:49:24 <cyrus_mc_>	Trying to template a file on a Windows machine and the path is c:\Program Files\NewRelic\newrelic-infra\newrelic-infra.yml. It appears a path with - in it causes an issue with win_template as it errors with : Get-AnsibleParam: Parameter 'path' has an invalid path
Nov 23 13:49:48 <cyrus_mc_>	if I just set the path to c:\Program Files\NewRelic\infra.yml it works
Nov 23 13:50:54 <cyrus_mc_>	is there some sort of escaping that is needed? I tried \ and \\ before - but no go
Nov 23 14:00:42 <cyrus_mc_>	anyone provide any insight?
Nov 23 14:03:09 <bradlane>	put the whole path in quotes
Nov 23 14:06:18 <cyrus_mc_>	bradlane: already tried that
Nov 23 14:06:19 <cyrus_mc_>	same error
Nov 23 14:11:57 <cyrus_mc_>	Found the fix. I was using the following syntax win_template: src=... dest=... just switched to the multi line with src and dest on separate lines (so the full yaml syntax)
Nov 23 14:11:58 <cyrus_mc_>	that worked
Nov 23 14:31:03 <gundalow>	Any django users: https://github.com/ansible/ansible/pull/46544
Nov 23 14:57:35 <gundalow>	Reminder, on Thursday 29th Nov we are doing a big PR review session.  Even if you are new to contributing to Ansible this is a great opportunity to get involved! https://github.com/ansible/community/issues/407
Nov 23 14:57:44 <gundalow>	All you need is a bit of time and a GitHub account
Nov 23 15:56:04 <mrproper>	Is anyone available to verify https://github.com/ansible/ansible/issues/49030? You'll need a Digital Ocean account for validation.
Nov 23 15:56:40 <mrproper>	I've seen it on two separate installs personally.
Nov 23 16:28:20 <geekodour08>	is there any way to unarchive+rename the directory on the same directive?
Nov 23 16:28:38 <geekodour08>	using the unarchive module?
Nov 23 16:30:18 <bcoca>	ansible-doc unarchive
Nov 23 16:46:05 <fine121>	hi guys, I have the lists below:
Nov 23 16:46:16 <fine121>	- name: set fact list1
Nov 23 16:46:16 <fine121>	  set_fact:
Nov 23 16:46:16 <fine121>	    list1: [ ["alias1"], ["alias2","alias3","alias4"] ]
Nov 23 16:46:16 <fine121>	- name: set fact list2
Nov 23 16:46:18 <fine121>	  set_fact:
Nov 23 16:46:20 <fine121>	    list2: [ ["expires"], ["expires","ok","ok"] ]
Nov 23 16:46:29 <fine121>	what I want to achieve:
Nov 23 16:46:46 <fine121>	"dict_final": [
Nov 23 16:46:46 <fine121>	        {
Nov 23 16:46:46 <fine121>	            "result": {
Nov 23 16:46:46 <fine121>	                "alias": "alias1",
Nov 23 16:46:46 <fine121>	                "expiry": "expires"
Nov 23 16:46:48 <fine121>	            }
Nov 23 16:46:49 <bcoca>	pastebin/gist plesz
Nov 23 16:46:50 <fine121>	        },
Nov 23 16:46:52 <fine121>	        {
Nov 23 16:46:54 <fine121>	            "result": {
Nov 23 16:46:56 <fine121>	                "alias": "alias2",
Nov 23 16:46:58 <fine121>	                "expiry": "expires"
Nov 23 16:47:00 <bcoca>	dont post soo much here or you'll get kicked
Nov 23 16:47:00 <fine121>	            }
Nov 23 16:47:02 <fine121>	        },
Nov 23 16:47:04 <fine121>	        {
Nov 23 16:47:06 <fine121>	            "result": {
Nov 23 16:47:08 <fine121>	                "alias": "alias3",
Nov 23 16:47:09 <bcoca>	its also unreadable in many clients
Nov 23 16:47:10 <fine121>	                "expiry": "ok"
Nov 23 16:47:12 <fine121>	            }
Nov 23 16:47:14 <fine121>	        }  
Nov 23 16:47:18 <fine121>	    ]
Nov 23 16:47:20 <fine121>	alright will do
Nov 23 16:47:22 <fine121>	sorry
Nov 23 16:47:53 <bcoca>	also, bad day to ask questions most people are either out or about to be out
Nov 23 16:47:57 <bcoca>	day/time
Nov 23 16:52:31 <fine121>	okay thanks
Nov 23 16:52:35 <fine121>	https://pastebin.com/Lt02aBkP
Nov 23 17:04:02 <centrex>	Hello, I'm trying to create a playbook, that will install a package to a windows machine made to a dynamically specified host, since we'll be creating VMs for qa/testing purposes, and then shutting them down.  So for using something like win_package, I have to have the host configured in /etc/ansible/hosts ?  which isn't ideal, I'd rather specify the host via hostname through commandline/variabble
Nov 23 17:04:05 <centrex>	is such a thing possible?
Nov 23 17:10:23 <bcoca>	 -i 'hostname, '
Nov 23 17:14:32 <centrex>	playbooks take -i hostname?
Nov 23 17:16:38 <centrex>	I thought that was to specify the hostname defined in /etc/ansible/hosts
Nov 23 17:18:33 <bcoca>	no, playbooks dont take parameters, ansibile-playbook does
Nov 23 17:18:49 <bcoca>	no, that is the default, but you can have many diff inventory sources
Nov 23 17:19:23 <centrex>	so I do have to have an inventory source, I can't just specify a dns hostname?
Nov 23 17:19:58 <bcoca>	 -i 'dnsname,' <= that is an 'inventory source', comma separated string inline to command line qualifies as such
Nov 23 17:20:26 <centrex>	ah okay, thank you
Nov 23 17:35:02 <greatgatsby>	fine121 left?  (I don't display join/leave messages).   Oh well, here's my solution, flatten (with sum) and zip:  https://paste.pound-python.org/show/sRSBrHzvUwttK42MbDA3/
