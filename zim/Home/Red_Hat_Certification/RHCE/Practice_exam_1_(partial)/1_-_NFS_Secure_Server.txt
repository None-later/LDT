Content-Type: text/x-zim-wiki
Wiki-Format: zim 0.4
Creation-Date: 2018-03-16T22:02:29-04:00

====== 1 - NFS Secure Server ======
Created Friday 16 March 2018
(NTS: I typed these up from memory, there may be typos).


1 a) On Server: (/public)
systemctl start nfs-server
systemctl enable nfs-server
firewall-cmd --permanent --add-service={nfs,rpc-bind,mountd}
firewall-cmd --reload 
mkdir /public
semanage fcontext -a -t public_content_t '/public(/.*)?'	#seems optional, but should do. (only needed if nfs secure mode)
restorecon -vRF [[/public]]
vim [[/ets/exports]]    :   [[/public]] 172.25.1.0/24(ro)
systemctl restart nfs-server

1 b) On client:
cd [[/mnt/]]
mkdir nfsmount 
vim [[/etc/fstab]]   :     server1:/public [[/mnt/nfsmount]] nfs defaults 0 0
mount -a
df -h



2 a) On Server  (/protected)
wget -O [[/etc/krb5.keytab]] http://classroom.example.com/pub/keytabs/server1.keytab
mkdir [[/protected]]
semanage fcontext -a -t public_content_rw_t '/protected(/.*)?'
restorecon -vRF /protected
vim [[/etc/sysconfig/nfs]]  ->> RPCNFSDARGS="-V 4.2"
systemctl enable nfs-secure-server
systemctl start nfs-secure-server
vim [[/etc/exports]]    :  [[/protected]] 172.25.1.0/24(rw,sync,sec=krb5p)
exportfs -arv
exportfs -s

mkdird [[/protected/project]]
cd protected
chown ldapuser1:ldapuser1 project
setfacl -m u:ldapuser2:rwx project
chown ldapuser2:ldapuser2 projectB


2 b) On client:
wget -O [[/etc/krb5.keytab]] http://classroom.example.com/pub/keytabs/desktop1.keytab
systemctl enable nfs-secure
systemctl start nfs-secure
mkdir -p /mnt/nfssecure
vim [[/etc/fstab]]   :   server1:/protected [[/mnt/nfssecure]] defaults,sec=krb5p,v4.2 0 0
mount -a
df -h

On server to validate:
ssh ldapuser1@desktop1
ssh ldapuser2@desktop1


